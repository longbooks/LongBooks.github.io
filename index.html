<!DOCTYPE html>
<html>
<head>
    <title>Youtube my data Clone</title>
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript" src="//www.google.com/jsapi"></script>
    <script type="text/javascript" src="https://apis.google.com/js/client.js?onload=onJSClientLoad"></script>
</head>
<body>
    <div id="login-container" class="pre-auth">
    <a href="#" id="login-link">CLICK ME</a> to continue.
    </div>
    <div class="post-auth">
connected
    </div>
    <script>
    (function(){
        var OAUTH_CLIENT_ID='316244741974-m4otm3490uhieom1ovcn0n00v2eq5c9j.apps.googleusercontent.com';
        var OAUTH_SCOPES='https://www.googleapis.com/auth/youtube.readonly';
        var channelID;
         
        window.onJSClientLoad=function(){
            gapi.auth.init(function(){
            window.setTimeout(checkAuth,1);
        });};
        
        function checkAuth(){
            gapi.auth.authorize({
                client_id:OAUTH_CLIENT_ID,
                scope:OAUTH_SCOPES,
                immediate:true
            },handleAuthResult);
        }
        
        function handleAuthResult(authResult)
        {
            if(authResult)
            {
                $('.pre-auth').hide();
                $('post-auth').show();
                loadApi();
            }
            else{
                $('.pre-auth').show();
                $('post-auth').hide();
                $('#login-link').click(function()
                {
                    gapi.auth.authorize({
                        client_id:OAUTH_CLIENT_ID,
                        scope:OAUTH_SCOPES,
                        immediate:false
                    },handleAuthResult);
                });
            }
        };
        
        function loadApi(){
            gapi.client.load("https://www.googleapis.com/discovery/v1/apis/youtube/v3/rest",function()
            {
                getUserChannel();

            });
        };

        function getUserChannel(){
            var result=gapi.client.youtube.channels.list(
                {
                    mine:true,
                    part:'id,contentDetails'
                });
                result.execute(function(response)
                {
                    if('error' in response)
                    {
                        console.log(response.error.message);
                    }
                    else
                    {
                        channelID=response.items[0];
                        displaychannel(channelID);
                    }
                });
            };
            
        function displaychannel(chal)
        {
            alert(chal);
        };
    })();
    </script>
</body>
</html>
