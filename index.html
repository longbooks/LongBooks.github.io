<!DOCTYPE html>
<html>
    <head>
        <script src="https://accounts.google.com/gsi/client" onload="initClient()" async defer></script>
    </head>
    <body>
        <script>
            var client;
            function initClient() {
                client = google.accounts.oauth2.initCodeClient({
                    client_id: '141290470186-e63pmerr4gft8cep5gptbbjlo3gcqn5u.apps.googleusercontent.com',
                    scope: 'https://www.googleapis.com/auth/youtube.readonly',
                    ux_mode:'popup',
                    callback: () => {
                        const xhr=new XMLHttpRequest();
                        xhr.open('GET', 'https://youtube.googleapis.com/youtube/v3/channels?part=snippet&mine=true&key=AIzaSyBTJnaY-IbClJu84zEEv1lGYQlXHvQeLu0',true);
                        xhr.responseType="json";
                        xhr.onload=()=>{
                            if(xhr.status===200){
                                console.log(xhr.response);
                            }else{
                                console.log("Error");
                            }
                        };
                        xhr.send();
                    }
                });
            }

            function execute() {
                return gapi.client.youtube.channels.list({
                    "part":[
                        "snippet,contentDetails,statistics"
                    ],
                    "mine": true
                })
                .then(function(response) {
                    // Handle the results here (response.result has the parsed body).
                    console.log("Response", response);
                },
                function(err) { 
                    console.error("Execute error", err);
                 });
            }
        </script>
        <button onclick="client.requestCode();">authorize and load</button>
        <button onclick="execute()">execute</button>
    </body>
</html>
